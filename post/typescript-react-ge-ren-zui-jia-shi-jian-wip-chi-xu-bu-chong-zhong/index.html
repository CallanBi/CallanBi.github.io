<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TypeScript + React ä¸ªäººæœ€ä½³å®è·µ(WIPæŒç»­è¡¥å……ä¸­) | Callan Bi&#39;s Blog</title>
<link rel="shortcut icon" href="https://CallanBi.github.io/favicon.ico?v=1662275411308">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://CallanBi.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="TypeScript + React ä¸ªäººæœ€ä½³å®è·µ(WIPæŒç»­è¡¥å……ä¸­) | Callan Bi&#39;s Blog - Atom Feed" href="https://CallanBi.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="å‰ç½®å·¥ä½œ

é˜…è¯»React Doc ä¸­ TS éƒ¨åˆ†
é˜…è¯» TypeScript Playground ä¸­ React éƒ¨åˆ†

å¼•å…¥ Reactï¼šæ°¸è¿œä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥ï¼ˆnamespace importï¼‰
import * as React f..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://CallanBi.github.io">
  <img class="avatar" src="https://CallanBi.github.io/images/avatar.png?v=1662275411308" alt="">
  </a>
  <h1 class="site-title">
    Callan Bi&#39;s Blog
  </h1>
  <p class="site-description">
    Callan Bi çš„åšå®¢ï¼Œè®°å½•æŠ€æœ¯æˆé•¿å’Œæ—¥å¸¸
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/CallanBi" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              TypeScript + React ä¸ªäººæœ€ä½³å®è·µ(WIPæŒç»­è¡¥å……ä¸­)
            </h2>
            <div class="post-info">
              <span>
                2021-07-04
              </span>
              <span>
                11 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="å‰ç½®å·¥ä½œ">å‰ç½®å·¥ä½œ</h1>
<ol>
<li><a href="https://reactjs.org/docs/static-type-checking.html#typescript">é˜…è¯»React Doc ä¸­ TS éƒ¨åˆ†</a></li>
<li><a href="https://reactjs.org/docs/static-type-checking.html#typescript">é˜…è¯» TypeScript Playground ä¸­ React éƒ¨åˆ†</a></li>
</ol>
<h1 id="å¼•å…¥-reactæ°¸è¿œä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥namespace-import">å¼•å…¥ Reactï¼šæ°¸è¿œä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥ï¼ˆnamespace importï¼‰</h1>
<pre><code class="language-javascirpt">import * as React from 'react';
import { useState } from 'react'; // å¯ä»¥å•ç‹¬å¯¼å‡ºä¸€éå†…éƒ¨é¡¹
import * as ReactDom from 'react-dom';
</code></pre>
<p>ä¸æ¨è <code>import React from 'react'</code>ã€‚<a href="https://twitter.com/dan_abramov/status/1308739731551858689">ğŸ‘‰ä¸ºä»€ä¹ˆï¼Ÿ</a><br>
è¿™ç§å¼•å…¥æ–¹å¼è¢«ç§°ä¸º <code>default export</code> ã€‚ä¸æ¨èçš„åŸå› æ˜¯ç¬¬React ä»…ä»…æ˜¯ä½œä¸ºä¸€ä¸ªå‘½åç©ºé—´å­˜åœ¨çš„ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šåƒä½¿ç”¨ä¸€ä¸ªå€¼ä¸€æ ·æ¥ä½¿ç”¨ Reactã€‚ä» React 16.13.0 å¼€å§‹ï¼ŒReact çš„å¯¼å‡ºæ–¹å¼ä¹Ÿå·²ç»æ›´æ­£ä¸º <code>export {xxx, ...} </code>çš„å½¢å¼äº†(<a href="https://github.com/facebook/react/commit/60016c448bb7d19fc989acd05dda5aca2e124381#diff-a9c08afc9ba1304a73e4235b3016b97c">commit</a>)ã€‚ä¹‹æ‰€ä»¥<code>default export</code>è¿˜å¯ä»¥ä½¿ç”¨ï¼Œæ˜¯å› ä¸ºç›®å‰ React çš„æ„å»ºäº§ç‰©æ˜¯ Commonjs è§„èŒƒçš„ï¼Œwebpack ç­‰æ„å»ºå·¥å…·åšäº†å…¼å®¹ã€‚</p>
<h1 id="ç»„ä»¶å¼€å‘">ç»„ä»¶å¼€å‘</h1>
<h2 id="1-å°½é‡ä½¿ç”¨function-componentå£°æ˜å³-reactfc">1. å°½é‡ä½¿ç”¨Function Componentå£°æ˜ï¼Œå³ React.FCï¼š</h2>
<pre><code class="language-javascript">export interface Props {
  /** The user's name */
  name: string;
  /** Should the name be rendered in bold */
  priority?: boolean
}

const PrintName: React.FC&lt;Props&gt; = (props) =&gt; {
  return (
    &lt;div&gt;
      &lt;p style={{ fontWeight: props.priority ? &quot;bold&quot; : &quot;normal&quot; }}&gt;{props.name}&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<p>æˆ‘ä¸€èˆ¬åœ¨å¼€å‘æ—¶ä½¿ç”¨ vscode snippets å¿«é€Ÿç”Ÿæˆï¼š</p>
<pre><code class="language-json">&quot;Functional, Folder Name&quot;: {
    &quot;prefix&quot;: &quot;ff&quot;,
    &quot;body&quot;: [
      &quot;import * as React from 'react';&quot;,
      &quot;&quot;,
      &quot;const { useRef, useState, useEffect, useMemo } = React;&quot;,
      &quot;&quot;,
      &quot;&quot;,
      &quot;interface ${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/}Props {&quot;,
      &quot;&quot;,
      &quot;}&quot;,
      &quot;&quot;,
			&quot;const defaultProps: ${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/}Props = {};&quot;,
			&quot;&quot;,
      &quot;const ${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/}: React.FC&lt;${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/}Props&gt; = (props: React.PropsWithChildren&lt;${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/}Props&gt; = defaultProps) =&gt; {&quot;,
      &quot;  const { } = props;&quot;,
      &quot;&quot;,
      &quot;  return (&quot;,
      &quot;&quot;,
      &quot;  );&quot;,
      &quot;};&quot;,
      &quot;&quot;,
      &quot;export default ${TM_DIRECTORY/.*[\\\\\\\\\\\\/](.*)$/$1/};&quot;,
      &quot;&quot;
    ],
    &quot;description&quot;: &quot;Generate a functional component template&quot;
  },
</code></pre>
<h1 id="hook-ç›¸å…³">Hook ç›¸å…³</h1>
<p>æ¨èå®‰è£…vscode æ’ä»¶ï¼š<a href="https://marketplace.visualstudio.com/items?itemName=AlDuncanson.react-hooks-snippets">React Hooks Snippets</a> å¿«é€Ÿå†™ hookï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h2 id="2-usestatet-å½“çŠ¶æ€åˆå§‹å€¼ä¸ºç©ºæ—¶æ¨èå†™å‡ºå®Œæ•´æ³›å‹å¦åˆ™å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹">2. useState<T>ï¼š å½“çŠ¶æ€åˆå§‹å€¼ä¸ºç©ºæ—¶ï¼Œæ¨èå†™å‡ºå®Œæ•´æ³›å‹ï¼Œå¦åˆ™å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</h2>
<p>åŸå› ï¼šä¸€äº›çŠ¶æ€åˆå§‹å€¼ä¸ºç©ºæ—¶ï¼Œéœ€è¦æ˜¾ç¤ºåœ°å£°æ˜ç±»å‹ï¼š</p>
<pre><code class="language-javascript">const [user, setUser] = React.useState&lt;User | null&gt;(null)
</code></pre>
<p>æ³¨æ„ï¼šå¦‚æœåˆå§‹å€¼ä¸º undefinedï¼Œå¯ä¸ç”¨åœ¨æ³›å‹ä¸­åŠ ä¸Š undefinedã€‚</p>
<h2 id="3-usememo-å’Œ-usecallback-ä¼šéšå¼æ¨æ–­ç±»å‹æ¨èä¸ä¼ æ³›å‹">3. useMemo() å’Œ useCallback() ä¼šéšå¼æ¨æ–­ç±»å‹ï¼Œæ¨èä¸ä¼ æ³›å‹</h2>
<p>æ³¨ï¼šä¸è¦ç»å¸¸ç”¨useCallbackï¼Œå› ä¸ºä¹Ÿä¼šå¢åŠ å¼€é”€ã€‚ä»…å½“ï¼š</p>
<ul>
<li>åŒ…è£…åœ¨ <code>React.memo()</code>ï¼ˆæˆ– shouldComponentUpdate ï¼‰ä¸­çš„ç»„ä»¶æ¥å—å›è°ƒ prop;</li>
<li>å½“å‡½æ•°ç”¨ä½œå…¶ä»– hooks çš„ä¾èµ–é¡¹æ—¶ <code>useEffect(...ï¼Œ[callback])</code>ã€‚</li>
</ul>
<h2 id="4-è‡ªå®šä¹‰hookå¦‚æœè¿”å›ä¸ºæ•°ç»„éœ€è¦æ‰‹åŠ¨æ·»åŠ -const-æ–­è¨€">4. è‡ªå®šä¹‰hookå¦‚æœè¿”å›ä¸ºæ•°ç»„ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ  const æ–­è¨€ï¼š</h2>
<pre><code class="language-javascript">function useLoading() {
  const [isLoading, setLoading] = React.useState(false);
  const load = (aPromise: Promise&lt;any&gt;) =&gt; {
    setLoading(true)
    return aPromise.then(() =&gt; setLoading(false));
  }
  // å®é™…éœ€è¦: [boolean, typeof load] ç±»å‹
  // è€Œä¸æ˜¯è‡ªåŠ¨æ¨å¯¼çš„ï¼š(boolean | typeof load)[]
  return [isLoading, load] as const;
}
</code></pre>
<p>æˆ–è€…å¯ä»¥ç›´æ¥å®šä¹‰è¿”å›ç±»å‹ï¼š</p>
<pre><code class="language-javascript">export function useLoading(): [
  boolean,
  (aPromise: Promise&lt;any&gt;) =&gt; Promise&lt;any&gt;
] {
  const [isLoading, setState] = React.useState(false)
  const load = (aPromise: Promise&lt;any&gt;) =&gt; {
    setState(true)
    return aPromise.then(() =&gt; setState(false))
  }
  return [isLoading, load]
}
</code></pre>
<h1 id="å…¶ä»–">å…¶ä»–</h1>
<h2 id="5-ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ä»£æ›¿é»˜è®¤å±æ€§">5. ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ä»£æ›¿é»˜è®¤å±æ€§</h2>
<pre><code class="language-javascript">interface GreetProps { age?: number }
const defaultProps: GreetProps = { age: 21 };
const Greet = (props: GreetProps = defaultProps) =&gt; {
  /* ... */
}
</code></pre>
<p>åŸå› ï¼šFunction Component çš„ defaultProps <a href="https://twitter.com/hswolff/status/1133759319571345408">æœ€ç»ˆä¼šè¢«åºŸå¼ƒ</a>ï¼Œä¸æ¨èä½¿ç”¨ã€‚<br>
å¦‚æœä»è¦ä½¿ç”¨defaultPropsï¼Œæ¨èå¦‚ä¸‹æ–¹å¼ï¼š</p>
<pre><code class="language-javascript">interface IProps {
  name: string
}
const defaultProps = {
  age: 25,
};

// ç±»å‹å®šä¹‰
type GreetProps = IProps &amp; typeof defaultProps;
const Greet = (props: GreetProps) =&gt; &lt;div&gt;&lt;/div&gt;
Greet.defaultProps = defaultProps;

// ä½¿ç”¨
const TestComponent = (props: React.ComponentProps&lt;typeof Greet&gt;) =&gt; {
  return &lt;h1 /&gt;
}
const el = &lt;TestComponent name=&quot;foo&quot; /&gt;
</code></pre>
<h2 id="6-å»ºè®®ä½¿ç”¨-interface-å®šä¹‰ç»„ä»¶-propsts-å®˜æ–¹æ¨èåšæ³•ä½¿ç”¨-type-ä¹Ÿå¯ä¸å¼ºåˆ¶">6. å»ºè®®ä½¿ç”¨ Interface å®šä¹‰ç»„ä»¶ propsï¼ˆTS å®˜æ–¹æ¨èåšæ³•ï¼‰ï¼Œä½¿ç”¨ type ä¹Ÿå¯ï¼Œä¸å¼ºåˆ¶</h2>
<p>type å’Œ interface çš„åŒºåˆ«ï¼štype ç±»å‹ä¸èƒ½äºŒæ¬¡ç¼–è¾‘ï¼Œè€Œ interface å¯ä»¥éšæ—¶æ‰©å±•ã€‚</p>
<h2 id="7-ä½¿ç”¨-componentprops-è·å–æœªè¢«å¯¼å‡ºçš„ç»„ä»¶å‚æ•°ç±»å‹ä½¿ç”¨-returntype-è·å–è¿”å›å€¼ç±»å‹">7. ä½¿ç”¨ ComponentProps è·å–æœªè¢«å¯¼å‡ºçš„ç»„ä»¶å‚æ•°ç±»å‹ï¼Œä½¿ç”¨ ReturnType è·å–è¿”å›å€¼ç±»å‹</h2>
<p>è·å–ç»„ä»¶å‚æ•°ç±»å‹ï¼š</p>
<pre><code class="language-javascript">// è·å–å‚æ•°ç±»å‹
import { Button } from 'library' // ä½†æ˜¯æœªå¯¼å‡ºprops type
type ButtonProps = React.ComponentProps&lt;typeof Button&gt; // è·å–props
type AlertButtonProps = Omit&lt;ButtonProps, 'onClick'&gt; // å»é™¤onClick
const AlertButton: React.FC&lt;AlertButtonProps&gt; = props =&gt; (
  &lt;Button onClick={() =&gt; alert('hello')} {...props} /&gt;
)
</code></pre>
<p>è·å–è¿”å›å€¼ç±»å‹ï¼š</p>
<pre><code class="language-javascript">// è·å–è¿”å›å€¼ç±»å‹
function foo() {
  return { baz: 1 }
}
type FooReturn = ReturnType&lt;typeof foo&gt; // { baz: number }
</code></pre>
<h2 id="8-å¯¹-type-æˆ–-interface-è¿›è¡Œæ³¨é‡Šæ—¶å°½é‡ä½¿ç”¨-ä»¥ä¾¿è·å¾—æ›´å¥½çš„ç±»å‹æç¤º">8. å¯¹ type æˆ– interface è¿›è¡Œæ³¨é‡Šæ—¶å°½é‡ä½¿ç”¨ /** */ï¼Œä»¥ä¾¿è·å¾—æ›´å¥½çš„ç±»å‹æç¤º</h2>
<pre><code class="language-javascript">/* âœ… */
/**
 * @param a æ³¨é‡Š1
 * @param b æ³¨é‡Š2
 */
type Test = {
  a: string;
  b: number;
};
const testObj: Test = {
  a: '123',
  b: 234,
};
</code></pre>
<p>å½“ hover åˆ° <code>Test</code> æ—¶ç±»å‹æç¤ºæ›´ä¸ºå‹å¥½ï¼š<br>
<img src="https://CallanBi.github.io/post-images/1625414942775.png" alt="" loading="lazy"></p>
<h2 id="9-ç»„ä»¶-props-ts-ç±»å‹è§„èŒƒ">9. ç»„ä»¶ Props ts ç±»å‹è§„èŒƒ</h2>
<pre><code class="language-javascript">type AppProps = {
  /** string */
  message: string;
  /** number */
  count: number;
  /** boolean */
  disabled: boolean;
  /** åŸºæœ¬ç±»å‹æ•°ç»„ */
  names: string[];
  /** å­—ç¬¦ä¸²å­—é¢é‡ */
  status: 'waiting' | 'success';
  /** å¯¹è±¡ï¼šåˆ—å‡ºå¯¹è±¡å…¨éƒ¨å±æ€§ */
  obj3: {
    id: string;
    title: string;
  };
  /** item ä¸ºå¯¹è±¡çš„æ•°ç»„ */
  objArr: {
    id: string;
    title: string;
  }[];
  /** å­—å…¸*/
  dict: Record&lt;string, MyTypeHere&gt;;
  /** ä»»æ„å®Œå…¨ä¸ä¼šè°ƒç”¨çš„å‡½æ•° */
  onSomething: Function;
  /** æ²¡æœ‰å‚æ•°&amp;è¿”å›å€¼çš„å‡½æ•° */
  onClick: () =&gt; void;
  /** æºå¸¦å‚æ•°çš„å‡½æ•° */
  onChange: (id: number) =&gt; void;
  /** æºå¸¦ç‚¹å‡»äº‹ä»¶çš„å‡½æ•°, ä¸è¦å†ç”¨ e: any äº† */
  onClick(e: React.MouseEvent&lt;HTMLButtonElement&gt;): void;
  /** å¯é€‰çš„å±æ€§ */
  optional?: OptionalType;
  children: React.ReactNode; // æœ€ä½³ï¼Œæ”¯æŒæ‰€æœ‰ç±»å‹(JSX.Element, JSX.Element[], string)
  renderChildren: (name: string) =&gt; React.ReactNode;
  style?: React.CSSProperties;
  onChange?: React.FormEventHandler&lt;HTMLInputElement&gt;; // è¡¨å•äº‹ä»¶
};
</code></pre>
<h2 id="10-ç»„ä»¶ä¸­-event-å¤„ç†">10. ç»„ä»¶ä¸­ event å¤„ç†</h2>
<p>å¸¸è§çš„Eventlç±»å‹ï¼š</p>
<pre><code class="language-javascript">React.SyntheticEvent&lt;T = Element&gt;
React.ClipboardEvent&lt;T = Element&gt;
React.DragEvent&lt;T = Element&gt;
React.FocusEvent&lt;T = Element&gt;
React.FormEvent&lt;T = Element&gt;
React.ChangeEvent&lt;T = Element&gt;
React.KeyboardEvent&lt;T = Element&gt;
React.MouseEvent&lt;T = Element&gt;
React.TouchEvent&lt;T = Element&gt;
React.PointerEvent&lt;T = Element&gt;
React.UIEvent&lt;T = Element&gt;
React.WheelEvent&lt;T = Element&gt;
React.AnimationEvent&lt;T = Element&gt;
React.TransitionEvent&lt;T = Element&gt;
</code></pre>
<p>å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°ï¼š</p>
<pre><code class="language-javascript">type changeFn = (e: React.FormEvent&lt;HTMLInputElement&gt;) =&gt; void;
</code></pre>
<p>å¦‚æœä¸å¤ªå…³å¿ƒäº‹ä»¶çš„ç±»å‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ React.SyntheticEventï¼Œå¦‚æœç›®æ ‡è¡¨å•æœ‰æƒ³è¦è®¿é—®çš„è‡ªå®šä¹‰å‘½åè¾“å…¥ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹æ‰©å±•:</p>
<pre><code class="language-javascript">const App: React.FC = () =&gt; {
  const onSubmit = (e: React.SyntheticEvent) =&gt; {
    e.preventDefault();
    const target = e.target as typeof e.target &amp; {
      password: { value: string; };
    }; // ç±»å‹æ‰©å±•
    const password = target.password.value;
  };
  return (
    &lt;form onSubmit={onSubmit}&gt;
      &lt;div&gt;
        &lt;label&gt;
          Password:
          &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;
        &lt;/label&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Log in&quot; /&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  );
};
</code></pre>
<h2 id="11-å°½é‡ä½¿ç”¨-optional-channing">11. å°½é‡ä½¿ç”¨ optional channing</h2>
<h2 id="12-å°½é‡ä½¿ç”¨-reactcomponentpropstypeof-component-å‡å°‘éå¿…è¦propså¯¼å‡º">12. å°½é‡ä½¿ç”¨ React.ComponentProps<typeof Component> å‡å°‘éå¿…è¦propså¯¼å‡º</h2>
<h2 id="13-ä¸è¦åœ¨-type-æˆ–-interface-ä¸­ä½¿ç”¨å‡½æ•°å£°æ˜">13. ä¸è¦åœ¨ type æˆ– interface ä¸­ä½¿ç”¨å‡½æ•°å£°æ˜</h2>
<pre><code class="language-javascript">/** âœ… */
interface ICounter {
  start: (value: number) =&gt; string
}

/** âŒ */
interface ICounter1 {
  start(value: number): string
}
</code></pre>
<h2 id="14-å½“å±€éƒ¨ç»„ä»¶ç»“åˆå¤šç»„ä»¶è¿›è¡Œç»„ä»¶é—´çŠ¶æ€é€šä¿¡æ—¶å¦‚æœä¸æ˜¯ç‰¹åˆ«å¤æ‚åˆ™ä¸éœ€è¦ç”¨mobxæˆ–è€…-å»ºè®®ç»“åˆ-usereducer-å’Œ-usecontext-ä¸€èµ·ä½¿ç”¨é¢‘ç¹çš„ç»„ä»¶é—´é€šä¿¡æœ€ä½³å®è·µ">14. å½“å±€éƒ¨ç»„ä»¶ç»“åˆå¤šç»„ä»¶è¿›è¡Œç»„ä»¶é—´çŠ¶æ€é€šä¿¡æ—¶ï¼Œå¦‚æœä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œåˆ™ä¸éœ€è¦ç”¨mobxæˆ–è€… å»ºè®®ç»“åˆ useReducer() å’Œ useContext() ä¸€èµ·ä½¿ç”¨ï¼Œé¢‘ç¹çš„ç»„ä»¶é—´é€šä¿¡æœ€ä½³å®è·µï¼š</h2>
<p><code>Store.ts</code></p>
<pre><code class="language-javascript">import * as React from 'react';

export interface State {
  state1: boolean;
  state2: boolean;
}

export const initState: State = {
  state1: false,
  state2: true,
};

export type Action = 'action1' | 'action2';

export const StoreContext = React.createContext&lt;{
  state: State;
  dispatch: React.Dispatch&lt;Action&gt;;
}&gt;({ state: initState, dispatch: value =&gt; { /** noop */ } });


export const reducer: React.Reducer&lt;State, Action&gt; = (state, action) =&gt; {
 // ç”¨ reducer çš„å¥½å¤„ä¹‹ä¸€æ˜¯å¯ä»¥æ‹¿åˆ°ä¹‹å‰çš„ state
  switch (action) {
    case 'action1':
      return { ...state, state1: !state.state1 };
    case 'action2':
      return { ...state, state2: !state.state2 };
    default:
      return state;
  }
};
</code></pre>
<p><code>WithProvider.tsx</code></p>
<pre><code class="language-javascript">import * as React from 'react';
import { StoreContext, reducer, initState } from './store';

const { useReducer } = React;

const WithProvider: React.FC&lt;Record&lt;string, unknown&gt;&gt; = (props: React.PropsWithChildren&lt;Record&lt;string, unknown&gt;&gt;) =&gt; {
  // å°† state ä½œä¸ºæ ¹èŠ‚ç‚¹çš„çŠ¶æ€æ³¨å…¥åˆ°å­ç»„ä»¶ä¸­
  const [state, dispatch] = useReducer(reducer, initState);
  const { children } = props;

  return &lt;StoreContext.Provider value={{ state, dispatch }}&gt;{children}&lt;/StoreContext.Provider&gt;;
};

export default WithProvider;
</code></pre>
<p>çˆ¶ç»„ä»¶ï¼š</p>
<pre><code class="language-javascript">import * as React from 'react';
import WithProvider from './withProvider';
import Component1 from './components/Component1';
import Component2 from './components/Component2';

const { useRef, useState, useEffect, useMemo } = React;

interface RankProps {}

const defaultProps: RankProps = {};

const Rank: React.FC&lt;RankProps&gt; = (props: React.PropsWithChildren&lt;RankProps&gt; = defaultProps) =&gt; {
  const {} = props;

  return (
    &lt;WithProvider&gt;
      &lt;Component1 /&gt;
      &lt;Component2 /&gt;
    &lt;/WithProvider&gt;
  );
};


export default Rank;

</code></pre>
<p>å­ç»„ä»¶åªéœ€è¦ import <code>StoreContext</code> ä¹‹å <code>useContext()</code> å°±èƒ½å¾—åˆ° state å’Œ dispatch</p>
<pre><code class="language-javascript">import * as React from 'react';
import { StoreContext } from '../../store';

const { useContext } = React;

interface Component1Props {}

const defaultProps: Component1Props = {};

const Component1: React.FC&lt;Component1Props&gt; = (props: React.PropsWithChildren&lt;Component1Props&gt; = defaultProps) =&gt; {
  const { state, dispatch } = useContext(StoreContext);

  const {} = props;

  return (
    &lt;&gt;
      state1: {state.state1 ? 'true' : 'false'}
      &lt;button
        type=&quot;button&quot;
        onClick={(): void =&gt; {
          dispatch('action1');
        }}
      &gt;
        changeState1 with Action1
      &lt;/button&gt;
    &lt;/&gt;
  );
};

export default React.memo(Component1); // å»ºè®®æœ‰context çš„åœ°æ–¹æœ€å¥½ memo ä¸€ä¸‹ï¼Œæé«˜æ€§èƒ½

</code></pre>
<p><code>Store.ts</code> å’Œ <code>WithProvider.tsx</code> å¯ä»¥é…ç½®æˆ vscode snippetsï¼Œéœ€è¦ç”¨åˆ°æ—¶ç›´æ¥ä½¿ç”¨ã€‚</p>
<h2 id="15-ç±»-golang-é£æ ¼çš„å¼‚æ­¥æ¥å£æœ€ä½³å®è·µ">15. ç±» Golang é£æ ¼çš„å¼‚æ­¥æ¥å£æœ€ä½³å®è·µ</h2>
<pre><code class="language-javascript">const asyncTo = &lt;T, E = Error&gt;(p: Promise&lt;T&gt;): Promise&lt;[T, null] | [undefined, E]&gt; =&gt;
  p.then&lt;[T, null]&gt;((data: T) =&gt; [data, null]).catch&lt;[undefined, E]&gt;((err: E) =&gt; [undefined, err]);

const [res1, err1] = await asyncTo(new Promise(resolve =&gt; resolve('success'))); // res1: 'success', err1: null

const [res2, err2] = await asyncTo(new Promise((_, reject) =&gt; reject('error'))); // res2: undefined, err2: 'error'
</code></pre>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p>[1] <a href="https://mp.weixin.qq.com/s/mUblBpj6pmdxz9mLKEDJTw">React + TypeScript å®è·µ</a><br>
[2] <a href="https://juejin.cn/post/6844903938093744135">ç²¾è¯»ã€ŠReact Hooks æœ€ä½³å®è·µã€‹</a></p>
<p><strong>æ¬¢è¿åœ¨è¯„è®ºæˆ– issue ä¸­è®¨è®ºï¼ŒæŒ‡å‡ºä¸åˆç†ä¹‹å¤„ï¼Œè¡¥å……å…¶ä»–æœ€ä½³å®è·µ~</strong></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E5%89%8D%E7%BD%AE%E5%B7%A5%E4%BD%9C">å‰ç½®å·¥ä½œ</a></li>
<li><a href="#%E5%BC%95%E5%85%A5-react%E6%B0%B8%E8%BF%9C%E4%BD%BF%E7%94%A8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E5%AF%BC%E5%85%A5namespace-import">å¼•å…¥ Reactï¼šæ°¸è¿œä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥ï¼ˆnamespace importï¼‰</a></li>
<li><a href="#%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91">ç»„ä»¶å¼€å‘</a>
<ul>
<li><a href="#1-%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8function-component%E5%A3%B0%E6%98%8E%E5%8D%B3-reactfc">1. å°½é‡ä½¿ç”¨Function Componentå£°æ˜ï¼Œå³ React.FCï¼š</a></li>
</ul>
</li>
<li><a href="#hook-%E7%9B%B8%E5%85%B3">Hook ç›¸å…³</a>
<ul>
<li><a href="#2-usestatet-%E5%BD%93%E7%8A%B6%E6%80%81%E5%88%9D%E5%A7%8B%E5%80%BC%E4%B8%BA%E7%A9%BA%E6%97%B6%E6%8E%A8%E8%8D%90%E5%86%99%E5%87%BA%E5%AE%8C%E6%95%B4%E6%B3%9B%E5%9E%8B%E5%90%A6%E5%88%99%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8A%A8%E6%8E%A8%E6%96%AD%E7%B1%BB%E5%9E%8B">2. useState<T>ï¼š å½“çŠ¶æ€åˆå§‹å€¼ä¸ºç©ºæ—¶ï¼Œæ¨èå†™å‡ºå®Œæ•´æ³›å‹ï¼Œå¦åˆ™å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</a></li>
<li><a href="#3-usememo-%E5%92%8C-usecallback-%E4%BC%9A%E9%9A%90%E5%BC%8F%E6%8E%A8%E6%96%AD%E7%B1%BB%E5%9E%8B%E6%8E%A8%E8%8D%90%E4%B8%8D%E4%BC%A0%E6%B3%9B%E5%9E%8B">3. useMemo() å’Œ useCallback() ä¼šéšå¼æ¨æ–­ç±»å‹ï¼Œæ¨èä¸ä¼ æ³›å‹</a></li>
<li><a href="#4-%E8%87%AA%E5%AE%9A%E4%B9%89hook%E5%A6%82%E6%9E%9C%E8%BF%94%E5%9B%9E%E4%B8%BA%E6%95%B0%E7%BB%84%E9%9C%80%E8%A6%81%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0-const-%E6%96%AD%E8%A8%80">4. è‡ªå®šä¹‰hookå¦‚æœè¿”å›ä¸ºæ•°ç»„ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ  const æ–­è¨€ï¼š</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96">å…¶ä»–</a>
<ul>
<li><a href="#5-%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%80%BC%E4%BB%A3%E6%9B%BF%E9%BB%98%E8%AE%A4%E5%B1%9E%E6%80%A7">5. ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ä»£æ›¿é»˜è®¤å±æ€§</a></li>
<li><a href="#6-%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8-interface-%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6-propsts-%E5%AE%98%E6%96%B9%E6%8E%A8%E8%8D%90%E5%81%9A%E6%B3%95%E4%BD%BF%E7%94%A8-type-%E4%B9%9F%E5%8F%AF%E4%B8%8D%E5%BC%BA%E5%88%B6">6. å»ºè®®ä½¿ç”¨ Interface å®šä¹‰ç»„ä»¶ propsï¼ˆTS å®˜æ–¹æ¨èåšæ³•ï¼‰ï¼Œä½¿ç”¨ type ä¹Ÿå¯ï¼Œä¸å¼ºåˆ¶</a></li>
<li><a href="#7-%E4%BD%BF%E7%94%A8-componentprops-%E8%8E%B7%E5%8F%96%E6%9C%AA%E8%A2%AB%E5%AF%BC%E5%87%BA%E7%9A%84%E7%BB%84%E4%BB%B6%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B%E4%BD%BF%E7%94%A8-returntype-%E8%8E%B7%E5%8F%96%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B">7. ä½¿ç”¨ ComponentProps è·å–æœªè¢«å¯¼å‡ºçš„ç»„ä»¶å‚æ•°ç±»å‹ï¼Œä½¿ç”¨ ReturnType è·å–è¿”å›å€¼ç±»å‹</a></li>
<li><a href="#8-%E5%AF%B9-type-%E6%88%96-interface-%E8%BF%9B%E8%A1%8C%E6%B3%A8%E9%87%8A%E6%97%B6%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8-%E4%BB%A5%E4%BE%BF%E8%8E%B7%E5%BE%97%E6%9B%B4%E5%A5%BD%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%8F%90%E7%A4%BA">8. å¯¹ type æˆ– interface è¿›è¡Œæ³¨é‡Šæ—¶å°½é‡ä½¿ç”¨ /** */ï¼Œä»¥ä¾¿è·å¾—æ›´å¥½çš„ç±»å‹æç¤º</a></li>
<li><a href="#9-%E7%BB%84%E4%BB%B6-props-ts-%E7%B1%BB%E5%9E%8B%E8%A7%84%E8%8C%83">9. ç»„ä»¶ Props ts ç±»å‹è§„èŒƒ</a></li>
<li><a href="#10-%E7%BB%84%E4%BB%B6%E4%B8%AD-event-%E5%A4%84%E7%90%86">10. ç»„ä»¶ä¸­ event å¤„ç†</a></li>
<li><a href="#11-%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8-optional-channing">11. å°½é‡ä½¿ç”¨ optional channing</a></li>
<li><a href="#12-%E5%B0%BD%E9%87%8F%E4%BD%BF%E7%94%A8-reactcomponentpropstypeof-component-%E5%87%8F%E5%B0%91%E9%9D%9E%E5%BF%85%E8%A6%81props%E5%AF%BC%E5%87%BA">12. å°½é‡ä½¿ç”¨ React.ComponentProps<typeof Component> å‡å°‘éå¿…è¦propså¯¼å‡º</a></li>
<li><a href="#13-%E4%B8%8D%E8%A6%81%E5%9C%A8-type-%E6%88%96-interface-%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E">13. ä¸è¦åœ¨ type æˆ– interface ä¸­ä½¿ç”¨å‡½æ•°å£°æ˜</a></li>
<li><a href="#14-%E5%BD%93%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6%E7%BB%93%E5%90%88%E5%A4%9A%E7%BB%84%E4%BB%B6%E8%BF%9B%E8%A1%8C%E7%BB%84%E4%BB%B6%E9%97%B4%E7%8A%B6%E6%80%81%E9%80%9A%E4%BF%A1%E6%97%B6%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%98%AF%E7%89%B9%E5%88%AB%E5%A4%8D%E6%9D%82%E5%88%99%E4%B8%8D%E9%9C%80%E8%A6%81%E7%94%A8mobx%E6%88%96%E8%80%85-%E5%BB%BA%E8%AE%AE%E7%BB%93%E5%90%88-usereducer-%E5%92%8C-usecontext-%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8%E9%A2%91%E7%B9%81%E7%9A%84%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">14. å½“å±€éƒ¨ç»„ä»¶ç»“åˆå¤šç»„ä»¶è¿›è¡Œç»„ä»¶é—´çŠ¶æ€é€šä¿¡æ—¶ï¼Œå¦‚æœä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œåˆ™ä¸éœ€è¦ç”¨mobxæˆ–è€… å»ºè®®ç»“åˆ useReducer() å’Œ useContext() ä¸€èµ·ä½¿ç”¨ï¼Œé¢‘ç¹çš„ç»„ä»¶é—´é€šä¿¡æœ€ä½³å®è·µï¼š</a></li>
<li><a href="#15-%E7%B1%BB-golang-%E9%A3%8E%E6%A0%BC%E7%9A%84%E5%BC%82%E6%AD%A5%E6%8E%A5%E5%8F%A3%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">15. ç±» Golang é£æ ¼çš„å¼‚æ­¥æ¥å£æœ€ä½³å®è·µ</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://CallanBi.github.io/post/yi-shi-yong-webpack-chai-bao-de-100-zheng-que-de-zuo-fa-the-100-correct-way-to-split-your-chunks-with-webpack/">
              <h3 class="post-title">
                ã€è¯‘ã€‘ä½¿ç”¨ Webpack æ‹†åŒ…çš„ 100% æ­£ç¡®çš„åšæ³• / The 100% correct way to split your chunks with Webpack
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: 'dda136bbf45377c648de',
    clientSecret: 'f43305dcc30bf8a19537657df304ae5532b31dda',
    repo: 'my-blog-storage',
    owner: 'CallanBi',
    admin: ['CallanBi'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  
  <a class="rss" href="https://CallanBi.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
